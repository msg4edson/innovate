<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cs_topic">
    <sys_cs_topic action="INSERT_OR_UPDATE">
        <active>true</active>
        <applicability>true</applicability>
        <autopilot_topic>false</autopilot_topic>
        <cb_topic_id display_value="Survey Poc">9b8b85b887a591102840eb173cbb35fa</cb_topic_id>
        <channels/>
        <definition>{"id":"9b8b85b887a591102840eb173cbb35fa","name":"Survey Poc","system_topic":false,"autopilot_topic":false,"vendor_id":"c2f0b8f187033200246ddd4c97cb0bb9","description":"Survey Poc","applicability":"true","categories":[],"key_phrases":[],"variables":[{"name":"surveyInstanceId","type":"java.lang.Object"},{"name":"surveyQuestions","type":"java.lang.Object"},{"name":"questionIndex","type":"java.lang.Object","init_value":"-1"},{"name":"questionCount","type":"java.lang.Object","init_value":"0"},{"name":"surveyAnswers","type":"java.lang.Object","init_value":"\"{}\""},{"name":"choiceTypes","type":"java.lang.Object","init_value":"\"choice,scale,numericscale\""},{"name":"currentQuestionId","type":"java.lang.Object"},{"name":"currentQuestionType","type":"java.lang.Object"},{"name":"currentQuestionMetric","type":"java.lang.Object"},{"name":"currentQuestionDisplay","type":"java.lang.Object"},{"name":"introduction","type":"java.lang.Object"},{"name":"endNote","type":"java.lang.Object"},{"name":"textTypes","type":"java.lang.Object","init_value":"\"string,long,percentage\""},{"name":"currentQuestionMax","type":"java.lang.Object"},{"name":"currentQuestionMin","type":"java.lang.Object"},{"name":"currentAnswerValidation","type":"java.lang.Object"},{"name":"currentAnswerErrorMsg","type":"java.lang.Object"},{"name":"surveyVerificationMsg","type":"java.lang.Object"},{"name":"currentQuestionMandatory","type":"java.lang.Object","init_value":"true"},{"name":"_topic_postchat_user_id","type":"java.lang.Object"},{"name":"surveyName","type":"java.lang.Object"},{"name":"LiveAgent_pre_chat_survey_name","type":"java.lang.Object"},{"name":"LiveAgent_post_chat_survey_name","type":"java.lang.Object"},{"name":"LiveAgent_pre_assessment_instance","type":"java.lang.Object"},{"name":"LiveAgent_post_assessment_instance","type":"java.lang.Object"},{"name":"defaultSurveyName","type":"java.lang.Object"},{"name":"currentQuestionFieldValidator","type":"java.lang.Object"},{"name":"currentQuestionReferenceTable","type":"java.lang.Object"},{"name":"currentQuestionReferenceCondition","type":"java.lang.Object"},{"name":"optionsCount_16fb1f224b724fb996c94eefab3d9c06","type":"java.lang.Object"},{"name":"optionsCount_87bfa0c129514fef88d414679852002f","type":"java.lang.Object"},{"name":"optionsCount_85acd4f511814be192263f3144b2fa72","type":"java.lang.Object"},{"name":"__multipart_total__3d281abf4c1445e88f6c4e9f4355b5aa","type":"java.lang.Object"},{"name":"__multipart_idx__3d281abf4c1445e88f6c4e9f4355b5aa","type":"java.lang.Object"},{"name":"__multipart_valid__3d281abf4c1445e88f6c4e9f4355b5aa","type":"java.lang.Object"},{"name":"_reusable_topic_outputs_var","type":"java.lang.Object","init_value":"(function execute() {return JSON.stringify({\"populated\":false,\"values\":{}})})()"},{"name":"__segment_trigger_c4f28e8715ca4d87a6ff3db95cddd198_done","type":"java.lang.Object","init_value":"false"},{"name":"previous_graph_node","type":"java.lang.Object"}],"fields":[{"type":"Picture","name":"show_image_scale_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"dynamic_enum_list":{"name":"show_image_scale_question","props":[{"name":"value","isItemValue":true,"isPicture":false},{"name":"name","isItemValue":false,"isPicture":false},{"name":"body","isItemValue":false,"isPicture":true}]},"binding":{"write_to":[],"enum_list":{"expression":"(function execute() {var vaRuntimeUtil = new global.VaTopicRuntimeUtil();vaVars.optionsCount_16fb1f224b724fb996c94eefab3d9c06 = 0; var funcObj = {\"buildOptions\": function() {return (function execute() {\n    var i = vaVars.questionIndex;\n    var questions = JSON.parse(vaVars.surveyQuestions);\n    var choices = questions[i].choices;\n    var options = [];\n    for (var j = 0; j &lt; choices.length; j++) {\n        var c = choices[j];\n        options.push({\n            'Name': c.display,\n            'Value': c.value,\n            'Body': c.unselected\n        });\n    }\n\n    return options;\n})();}};function isValid(option) {return !gs.nil(option) &amp;&amp; !gs.nil(option.value) &amp;&amp; !gs.nil(option.name) &amp;&amp; !gs.nil(option.body);}function fixInvalid(invalidOption) {var fixedOption = {'value': 'no_data', 'name': 'no_data', 'body': 'no_data', 'description': ''};if (!gs.nil(invalidOption)) {fixedOption.value = !gs.nil(invalidOption.value) ? invalidOption.value : fixedOption.value;fixedOption.name = !gs.nil(invalidOption.name) ? invalidOption.name : fixedOption.name;fixedOption.body = !gs.nil(invalidOption.body) ? invalidOption.body : fixedOption.body;fixedOption.description = !gs.nil(invalidOption.description) ? invalidOption.description : fixedOption.description;}return fixedOption;}function normalizeKeys(obj){Object.keys(obj).forEach(function (key) {var k = key.toLowerCase();if (k !== key) {obj[k] = obj[key];delete obj[key];}});return (obj);}var carouselOptions = [];carouselOptions = vaRuntimeUtil.executeFunction(funcObj, 'buildOptions');var noOptions = gs.nil(carouselOptions) || carouselOptions.length==0;if (noOptions) {carouselOptions = [];}else {var invalidCount = 0;var normalizedChoiceOptions = [];for (var i = 0; i &lt; carouselOptions.length; i++) {normalizedChoiceOptions.push(normalizeKeys(carouselOptions[i]));}carouselOptions = normalizedChoiceOptions;for (var i = 0; i &lt; carouselOptions.length; i++) {if (gs.nil(carouselOptions[i].name)) {carouselOptions[i].name = carouselOptions[i].value;}}for (var i = 0; i &lt; carouselOptions.length; i++) {if (!isValid(carouselOptions[i])) {invalidCount++;carouselOptions[i] = fixInvalid(carouselOptions[i]);}}noOptions = invalidCount === carouselOptions.length;if (noOptions) {carouselOptions = [];}vaVars.optionsCount_16fb1f224b724fb996c94eefab3d9c06 = carouselOptions.length; return carouselOptions;}})();"}}},{"type":"String","name":"show_text_input_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"Boolean","name":"show_boolean_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[]},{"type":"ID","name":"show_choice_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"dynamic_enum_list":{"name":"show_choice_question","props":[{"name":"value","isItemValue":true,"isPicture":false},{"name":"label","isItemValue":false,"isPicture":false}]},"binding":{"write_to":[],"enum_list":{"expression":"(function execute() {var vaRuntimeUtil = new global.VaTopicRuntimeUtil();vaVars.optionsCount_87bfa0c129514fef88d414679852002f = 0; var funcObj = {\"buildOptions\": function() {return (function execute() {\n    var i = vaVars.questionIndex;\n    var questions = JSON.parse(vaVars.surveyQuestions);\n    var choices = questions[i].choices;\n    var options = [];\n    for (var j = 0; j &lt; choices.length; j++) {\n        var c = choices[j];\n        options.push({\n            'render_style':'bubble',\n            'label': c.display,\n            'value': c.value\n        });\n    }\n\n    return options;\n})();}};function isValid(option) {return !gs.nil(option) &amp;&amp; !gs.nil(option.value) &amp;&amp; !gs.nil(option.label);}function fixInvalid(invalidOption) {var fixedOption = {'value': 'no_data', 'label': 'no_data'};if (!gs.nil(invalidOption)) {fixedOption.value = !gs.nil(invalidOption.value) ? invalidOption.value : fixedOption.value;fixedOption.label = !gs.nil(invalidOption.label) ? invalidOption.label : fixedOption.label;}return fixedOption;}function normalizeKeys(obj){Object.keys(obj).forEach(function (key) {var k = key.toLowerCase();if (k !== key) {obj[k] = obj[key];delete obj[key];}});return (obj);}var choiceOptions = [];choiceOptions = vaRuntimeUtil.executeFunction(funcObj, 'buildOptions');var noOptions = gs.nil(choiceOptions) || choiceOptions.length==0;if (noOptions) {choiceOptions = [];}else {var invalidCount = 0;var normalizedChoiceOptions = [];for (var i = 0; i &lt; choiceOptions.length; i++) {normalizedChoiceOptions.push(normalizeKeys(choiceOptions[i]));}choiceOptions = normalizedChoiceOptions;for (var i = 0; i &lt; choiceOptions.length; i++) {if (gs.nil(choiceOptions[i].label)) {choiceOptions[i].label = choiceOptions[i].value;}}for (var i = 0; i &lt; choiceOptions.length; i++) {if (!isValid(choiceOptions[i])) {invalidCount++;choiceOptions[i] = fixInvalid(choiceOptions[i]);}}noOptions = invalidCount === choiceOptions.length;if (noOptions) {choiceOptions = [];}vaVars.optionsCount_87bfa0c129514fef88d414679852002f = choiceOptions.length;return choiceOptions;}})();"}},"metadata_script":""},{"type":"Picture","name":"show_attachment_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[]},{"type":"Datetime","format":"Date","static_enum_list":[],"name":"show_date_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false},{"type":"Datetime","format":"Datetime","static_enum_list":[],"name":"show_datetime_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false},{"type":"String","name":"surveyid","unique":false,"key_phrases":[],"metadata":{"libraryMappingType":"input"},"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"Boolean","name":"verify_response","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[]},{"type":"String","name":"confirmationneeded","unique":false,"key_phrases":[],"metadata":{"libraryMappingType":"input"},"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"savequestionstocontext","unique":false,"key_phrases":[],"metadata":{"libraryMappingType":"input"},"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"Reference","table_name":"sys_user","name":"user","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[]},{"type":"ID","name":"show_reference_question","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"dynamic_enum_list":{"name":"show_reference_question","props":[{"name":"value","isItemValue":true,"isPicture":false},{"name":"label","isItemValue":false,"isPicture":false}]},"binding":{"write_to":[],"enum_list":{"expression":"(function execute() {var vaRuntimeUtil = new global.VaTopicRuntimeUtil();vaVars.optionsCount_85acd4f511814be192263f3144b2fa72 = 0; var funcObj = {\"buildOptions\": function() {return (function execute() {\n    var options = [];\n    var table = vaVars.currentQuestionReferenceTable;\n    var condition = vaVars.currentQuestionReferenceCondition;\n    if (!table)\n        return options;\n \n    var taskExtensions = new TableUtils(\"task\").getTableExtensions();\n    var isTask = (taskExtensions.indexOf(table) &gt; -1) ? true : false;\n\n    var gr = new GlideRecord(table);\n    if (condition)\n        gr.addEncodedQuery(condition);\n    gr.query();\n    while (gr.next()) {\n        options.push({\n            'render_style':'bubble',\n            'value': gr.sys_id + '',\n            'label': (isTask)? gr.number + ': ' + gr.short_description : gr.getDisplayValue()\n        });\n    }\n    return options;\n})();}};function isValid(option) {return !gs.nil(option) &amp;&amp; !gs.nil(option.value) &amp;&amp; !gs.nil(option.label);}function fixInvalid(invalidOption) {var fixedOption = {'value': 'no_data', 'label': 'no_data'};if (!gs.nil(invalidOption)) {fixedOption.value = !gs.nil(invalidOption.value) ? invalidOption.value : fixedOption.value;fixedOption.label = !gs.nil(invalidOption.label) ? invalidOption.label : fixedOption.label;}return fixedOption;}function normalizeKeys(obj){Object.keys(obj).forEach(function (key) {var k = key.toLowerCase();if (k !== key) {obj[k] = obj[key];delete obj[key];}});return (obj);}var choiceOptions = [];choiceOptions = vaRuntimeUtil.executeFunction(funcObj, 'buildOptions');var noOptions = gs.nil(choiceOptions) || choiceOptions.length==0;if (noOptions) {choiceOptions = [];}else {var invalidCount = 0;var normalizedChoiceOptions = [];for (var i = 0; i &lt; choiceOptions.length; i++) {normalizedChoiceOptions.push(normalizeKeys(choiceOptions[i]));}choiceOptions = normalizedChoiceOptions;for (var i = 0; i &lt; choiceOptions.length; i++) {if (gs.nil(choiceOptions[i].label)) {choiceOptions[i].label = choiceOptions[i].value;}}for (var i = 0; i &lt; choiceOptions.length; i++) {if (!isValid(choiceOptions[i])) {invalidCount++;choiceOptions[i] = fixInvalid(choiceOptions[i]);}}noOptions = invalidCount === choiceOptions.length;if (noOptions) {choiceOptions = [];}vaVars.optionsCount_85acd4f511814be192263f3144b2fa72 = choiceOptions.length;return choiceOptions;}})();"}},"metadata_script":""},{"type":"Boolean","name":"RootDecisionBranch_edcbc9f897a5911044b4eaa61bdd2bf1","unique":false,"default_value":"true","key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[]},{"type":"String","name":"__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_dbfea879b6534ead8a8760734f7d15fe","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_6011a8913f454c5f8f2eaaa131969d9f","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_6c477affd88e47b6baa2bf2189abb1db","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_d247234716fa4d32a88aa182297546ea","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_e6dea0290dd9404db627f40ec07c016e","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_OutputPrompt_83e6c0162f974497bf0c38ba331ca93c","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptOutputPrompt_3d281abf4c1445e88f6c4e9f4355b5aa","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_RootDecision_6dcbc9f834a5911024c1cf56763fdcf1","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_fb79c9a906f64cb98f3d7605abe0902c","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_753d10c4610243a7afb9e2d6497440d0","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_OutputPrompt_2caec646461549eb9f074d49dd8da84a","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_StartGoal_950dcacbfc7d4324bb79ca53468f1162","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_d850c0da237c4cb1804f5255dda155de","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_5cab11de08604629a23a24f9bb6dc003","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_43028a8d0b22477a86cbf77f88f1b527","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_e5ad34e6099945d7849c834eef1bd479","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_a8d89721cb3e4a4db791922ecc6162a5","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_67f6b5c25c0349fca01f762818747a3f","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_b4a433df355d486696c9afc48ef463f3","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Decision_7ea23b4b7ed64e938ade9211dc995758","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_OutputPrompt_f6f516977b564f16b892a5fc51a780aa","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_Branch_deafcd47cf254d2d974bca8d99a6e274","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_TerminateGoal_ef9ce937b7b8414f94c69aa4d7332c0d","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true},{"type":"String","name":"__silent_ScriptedAction_6fc46a3c278b411b80ee85a4ceb31314","unique":false,"key_phrases":[],"mask_type":"NONE","list":false,"static_enum_list":[],"encrypt_if_secure":true}],"actions":[],"tasks":[{"type":"Consumer to system","show_as_button":true,"name":"primary","description":"primary","applicability":"vaVars.__segment_trigger_c4f28e8715ca4d87a6ff3db95cddd198_done==false &amp;&amp; true","mode":"Qmode","key_phrases":[],"greeting_msg":"vaInputs.initialize(\"user\");vaInputs.initialize(\"RootDecisionBranch_edcbc9f897a5911044b4eaa61bdd2bf1\");vaInputs.initialize(\"__silent_Branch_753d10c4610243a7afb9e2d6497440d0\");vaInputs.initialize(\"__silent_OutputPrompt_f6f516977b564f16b892a5fc51a780aa\");vaInputs.initialize(\"__silent_Branch_6c477affd88e47b6baa2bf2189abb1db\");vaInputs.initialize(\"__silent_Branch_dbfea879b6534ead8a8760734f7d15fe\");vaInputs.initialize(\"__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db\");vaInputs.initialize(\"show_text_input_question\");vaInputs.initialize(\"__silent_OutputPrompt_2caec646461549eb9f074d49dd8da84a\");vaInputs.initialize(\"__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb\");vaInputs.initialize(\"__silent_ScriptOutputPrompt_3d281abf4c1445e88f6c4e9f4355b5aa\");vaInputs.initialize(\"__silent_Decision_67f6b5c25c0349fca01f762818747a3f\");vaInputs.initialize(\"__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4\");vaInputs.initialize(\"show_attachment_question\");vaInputs.initialize(\"__silent_Branch_e6dea0290dd9404db627f40ec07c016e\");vaInputs.initialize(\"__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347\");vaInputs.initialize(\"__silent_Decision_7ea23b4b7ed64e938ade9211dc995758\");vaInputs.initialize(\"show_choice_question\");vaInputs.initialize(\"__silent_StartGoal_950dcacbfc7d4324bb79ca53468f1162\");vaInputs.initialize(\"__silent_TerminateGoal_ef9ce937b7b8414f94c69aa4d7332c0d\");vaInputs.initialize(\"__silent_ScriptedAction_b4a433df355d486696c9afc48ef463f3\");vaInputs.initialize(\"__silent_Decision_6011a8913f454c5f8f2eaaa131969d9f\");vaInputs.initialize(\"__silent_ScriptedAction_a8d89721cb3e4a4db791922ecc6162a5\");vaInputs.initialize(\"__silent_Branch_5cab11de08604629a23a24f9bb6dc003\");vaInputs.initialize(\"show_date_question\");vaInputs.initialize(\"show_image_scale_question\");vaInputs.initialize(\"__silent_OutputPrompt_83e6c0162f974497bf0c38ba331ca93c\");vaInputs.initialize(\"__silent_Decision_e5ad34e6099945d7849c834eef1bd479\");vaInputs.initialize(\"show_datetime_question\");vaInputs.initialize(\"show_reference_question\");vaInputs.initialize(\"__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86\");vaInputs.initialize(\"verify_response\");vaInputs.initialize(\"__silent_ScriptedAction_fb79c9a906f64cb98f3d7605abe0902c\");vaInputs.initialize(\"__silent_Branch_d247234716fa4d32a88aa182297546ea\");vaInputs.initialize(\"__silent_ScriptedAction_6fc46a3c278b411b80ee85a4ceb31314\");vaInputs.initialize(\"__silent_Decision_RootDecision_6dcbc9f834a5911024c1cf56763fdcf1\");vaInputs.initialize(\"__silent_Branch_deafcd47cf254d2d974bca8d99a6e274\");vaInputs.initialize(\"__silent_Branch_RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1\");vaInputs.initialize(\"__silent_ScriptedAction_43028a8d0b22477a86cbf77f88f1b527\");vaInputs.initialize(\"show_boolean_question\");vaInputs.initialize(\"__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00\");vaInputs.initialize(\"__silent_Decision_d850c0da237c4cb1804f5255dda155de\");vaInputs.initialize(\"savequestionstocontext\");vaInputs.savequestionstocontext=JSON.parse('\"false\"');vaInputs.initialize(\"confirmationneeded\");vaInputs.confirmationneeded=JSON.parse('\"false\"');vaInputs.initialize(\"surveyid\");vaInputs.surveyid=JSON.parse('\"\"');null;","fields":[{"name":"__silent_Decision_RootDecision_6dcbc9f834a5911024c1cf56763fdcf1","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"RootDecision_for_goal_primary___RootDecision_6dcbc9f834a5911024c1cf56763fdcf1\";vaInputs.__silent_Decision_RootDecision_6dcbc9f834a5911024c1cf56763fdcf1=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"RootDecision_for_goal_primary___RootDecision_6dcbc9f834a5911024c1cf56763fdcf1\";var ackMsg=null;ackMsg=null;vaInputs.RootDecisionBranch_edcbc9f897a5911044b4eaa61bdd2bf1=true;(function() {vaInputs.__silent_Branch_RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1.reset();})();ackMsg;"},{"name":"__silent_Branch_RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1","applicable":"vaVars.previous_graph_node==\"RootDecision_for_goal_primary___RootDecision_6dcbc9f834a5911024c1cf56763fdcf1\" &amp;&amp; ((vaInputs.RootDecisionBranch_edcbc9f897a5911044b4eaa61bdd2bf1.getValue() == true))","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1___RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1\";vaInputs.__silent_Branch_RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1___RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_StartGoal_950dcacbfc7d4324bb79ca53468f1162.reset();})();ackMsg;"},{"name":"__silent_StartGoal_950dcacbfc7d4324bb79ca53468f1162","applicable":"vaVars.previous_graph_node==\"RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1___RootDecisionBranch_adcbc9f882a591102c4ef9954a16caf1\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Start___950dcacbfc7d4324bb79ca53468f1162\";vaInputs.__silent_StartGoal_950dcacbfc7d4324bb79ca53468f1162=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Start___950dcacbfc7d4324bb79ca53468f1162\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_6fc46a3c278b411b80ee85a4ceb31314.reset();})();ackMsg;"},{"name":"__silent_ScriptedAction_6fc46a3c278b411b80ee85a4ceb31314","applicable":"vaVars.previous_graph_node==\"Start___950dcacbfc7d4324bb79ca53468f1162\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Load survey instance___6fc46a3c278b411b80ee85a4ceb31314\";(function execute() {(function execute() {\n\tvar gr = new GlideRecord('asmt_metric_type');\n\tgr.get(vaInputs.surveyid);vaVars.endNote = vaSystem.getTranslation(gr, 'end_note', vaContext.getRequesterLang(), gr.end_note.getValue() || '');vaVars.introduction = vaSystem.getTranslation(gr, 'introduction', vaContext.getRequesterLang(), gr.introduction.getValue() || '');vaVars.surveyName = gr.name.toString();vaVars.surveyVerificationMsg = vaSystem.getSurveyVerificationMessage();\n})();})();vaInputs.__silent_ScriptedAction_6fc46a3c278b411b80ee85a4ceb31314=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Load survey instance___6fc46a3c278b411b80ee85a4ceb31314\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_fb79c9a906f64cb98f3d7605abe0902c.reset();})();ackMsg;"},{"name":"__silent_ScriptedAction_fb79c9a906f64cb98f3d7605abe0902c","applicable":"vaVars.previous_graph_node==\"Load survey instance___6fc46a3c278b411b80ee85a4ceb31314\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Load questions___fb79c9a906f64cb98f3d7605abe0902c\";(function execute() {(function execute() {\n    var gr = new GlideRecord('asmt_metric_category');\n    gr.addQuery('metric_type', vaInputs.surveyid);\n    gr.query();\n    gr.next();\n\n    var surveyCategory = gr.getUniqueValue();\n\n    var gr = new GlideRecord('asmt_metric')\n    gr.addQuery('category', surveyCategory);\n    gr.addQuery('active', true);\n    gr.orderBy('order');\n    gr.query();\n\n    var questions = [];\n    while (gr.next()) {\n        var question = {\n            sys_id: gr.getUniqueValue(),\n            scale: gr.scale + '',\n            metric: gr.sys_id + '',\n            type: gr.datatype + '',\n            display: vaSystem.getTranslation(gr, 'question', vaContext.getRequesterLang(), gr.question) + '',\n            dependsOn: gr.depends_on + '',\n            displayedWhen: gr.displayed_when + '',\n            name: gr.name + '',\n            max: gr.max + '',\n            min: gr.min + '',\n            mandatory: gr.mandatory + '',\n            field_validation: gr.field_validation + '',\n            reference_table: gr.reference_table + '',\n            condition: gr.condition + '',\n        };\n\n        // boolean and checkbox type questions use different displayed_when fields\n        var dependsOnType = gr.depends_on.datatype + '';\n        if (dependsOnType === 'boolean')\n            question['displayedWhen'] = gr.displayed_when_yesno + '';\n        else if (dependsOnType === 'checkbox')\n            question['displayedWhen'] = gr.displayed_when_checkbox + '';\n\n        questions.push(question);\n    }\n    vaVars.surveyQuestions = JSON.stringify(questions);\n    vaVars.questionCount = questions.length;\n})();})();vaInputs.__silent_ScriptedAction_fb79c9a906f64cb98f3d7605abe0902c=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Load questions___fb79c9a906f64cb98f3d7605abe0902c\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_OutputPrompt_f6f516977b564f16b892a5fc51a780aa.reset();})();ackMsg;"},{"name":"__silent_OutputPrompt_f6f516977b564f16b892a5fc51a780aa","applicable":"vaVars.previous_graph_node==\"Load questions___fb79c9a906f64cb98f3d7605abe0902c\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Introduction___f6f516977b564f16b892a5fc51a780aa\";vaInputs.__silent_OutputPrompt_f6f516977b564f16b892a5fc51a780aa=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Introduction___f6f516977b564f16b892a5fc51a780aa\";var ackMsg=null;ackMsg=(function execute() {return vaVars.introduction;})();(function() {vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();})();ackMsg;","acknowledge_msg_mask_type":"NONE"},{"name":"__silent_Decision_7ea23b4b7ed64e938ade9211dc995758","applicable":"vaVars.previous_graph_node==\"Set next question___1dd720d7fda945c1bb7cd0b26f6b9c86\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Out of questions?___7ea23b4b7ed64e938ade9211dc995758\";vaInputs.__silent_Decision_7ea23b4b7ed64e938ade9211dc995758=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Out of questions?___7ea23b4b7ed64e938ade9211dc995758\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_dbfea879b6534ead8a8760734f7d15fe.reset();})();(function() {vaInputs.__silent_Branch_d247234716fa4d32a88aa182297546ea.reset();})();ackMsg;"},{"name":"__silent_Branch_d247234716fa4d32a88aa182297546ea","applicable":"vaVars.previous_graph_node==\"Out of questions?___7ea23b4b7ed64e938ade9211dc995758\" &amp;&amp; (function execute() {\n    return vaVars.questionIndex &lt; vaVars.questionCount;\n})()\n","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"No___d247234716fa4d32a88aa182297546ea\";vaInputs.__silent_Branch_d247234716fa4d32a88aa182297546ea=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"No___d247234716fa4d32a88aa182297546ea\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_b4a433df355d486696c9afc48ef463f3.reset();})();ackMsg;"},{"name":"__silent_Branch_dbfea879b6534ead8a8760734f7d15fe","applicable":"vaVars.previous_graph_node==\"Out of questions?___7ea23b4b7ed64e938ade9211dc995758\" &amp;&amp; (function execute() {\n    return vaVars.questionIndex &gt;= vaVars.questionCount;\n})()\n","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Yes___dbfea879b6534ead8a8760734f7d15fe\";vaInputs.__silent_Branch_dbfea879b6534ead8a8760734f7d15fe=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Yes___dbfea879b6534ead8a8760734f7d15fe\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347.reset();})();(function() {vaInputs.__silent_Decision_d850c0da237c4cb1804f5255dda155de.reset();})();(function() {vaInputs.__silent_Branch_753d10c4610243a7afb9e2d6497440d0.reset();})();ackMsg;"},{"name":"__silent_ScriptedAction_b4a433df355d486696c9afc48ef463f3","applicable":"vaVars.previous_graph_node==\"No___d247234716fa4d32a88aa182297546ea\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Check question dependency___b4a433df355d486696c9afc48ef463f3\";(function execute() {(function execute() {\n    var i = vaVars.questionIndex;\n    var questions = JSON.parse(vaVars.surveyQuestions);\n    var q = questions[i];\n\n    var satisfied = true;\n    var hasDependency = !(!q.dependsOn);\n    vaVars.currentIsDependencySatisfied = !hasDependency || isSat(q);\n})();\n\nfunction isSat(q) {\n    var questions = JSON.parse(vaVars.surveyQuestions);\n    var answers = JSON.parse(vaVars.surveyAnswers);\n\n    var answerValid = false;\n    questions.forEach(function(question) {\n        if (question.metric !== q.dependsOn)\n            return;\n\n        var answerExists = question.sys_id in answers;\n        if (!answerExists)\n            return;\n\n        var selectedChoice = answers[question.sys_id]['value'];\n\n        if (question.type === 'boolean' || question.type === 'checkbox') {\n            if ((selectedChoice === true &amp;&amp; q.displayedWhen === '1') || (selectedChoice === false &amp;&amp; q.displayedWhen === '0'))\n                answerValid = true;\n        } else {\n            var choices = question.choices.filter(function(c) {\n                return c.value === selectedChoice;\n            });\n\n            if (choices.length &amp;&amp; choices[0].sys_id)\n                answerValid = q.displayedWhen.indexOf(choices[0].sys_id) !== -1;\n        }\n    });\n\n    return answerValid;\n};})();vaInputs.__silent_ScriptedAction_b4a433df355d486696c9afc48ef463f3=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Check question dependency___b4a433df355d486696c9afc48ef463f3\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Decision_6011a8913f454c5f8f2eaaa131969d9f.reset();})();(function() {vaInputs.__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00.reset();})();(function() {vaInputs.__silent_Branch_6c477affd88e47b6baa2bf2189abb1db.reset();})();ackMsg;"},{"name":"__silent_Decision_d850c0da237c4cb1804f5255dda155de","applicable":"vaVars.previous_graph_node==\"Yes___dbfea879b6534ead8a8760734f7d15fe\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Confirmation___d850c0da237c4cb1804f5255dda155de\";vaInputs.__silent_Decision_d850c0da237c4cb1804f5255dda155de=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Confirmation___d850c0da237c4cb1804f5255dda155de\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347.reset();})();(function() {vaInputs.__silent_Branch_753d10c4610243a7afb9e2d6497440d0.reset();})();ackMsg;"},{"name":"__silent_Branch_753d10c4610243a7afb9e2d6497440d0","applicable":"vaVars.previous_graph_node==\"Confirmation___d850c0da237c4cb1804f5255dda155de\" &amp;&amp; ((vaInputs.confirmationneeded.getValue() == \"true\"))","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Confirmation?___753d10c4610243a7afb9e2d6497440d0\";vaInputs.__silent_Branch_753d10c4610243a7afb9e2d6497440d0=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Confirmation?___753d10c4610243a7afb9e2d6497440d0\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptOutputPrompt_3d281abf4c1445e88f6c4e9f4355b5aa.reset();})();ackMsg;"},{"name":"__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347","applicable":"vaVars.previous_graph_node==\"Confirmation___d850c0da237c4cb1804f5255dda155de\" &amp;&amp; ((vaInputs.confirmationneeded.getValue() != \"true\"))","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"No___2f0ce9bdd0eb41e683658cd0e7434347\";vaInputs.__silent_Branch_2f0ce9bdd0eb41e683658cd0e7434347=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"No___2f0ce9bdd0eb41e683658cd0e7434347\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db.reset();})();ackMsg;"},{"name":"__silent_Decision_6011a8913f454c5f8f2eaaa131969d9f","applicable":"vaVars.previous_graph_node==\"Check question dependency___b4a433df355d486696c9afc48ef463f3\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Does question satisfy dependency?___6011a8913f454c5f8f2eaaa131969d9f\";vaInputs.__silent_Decision_6011a8913f454c5f8f2eaaa131969d9f=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Does question satisfy dependency?___6011a8913f454c5f8f2eaaa131969d9f\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00.reset();})();(function() {vaInputs.__silent_Branch_6c477affd88e47b6baa2bf2189abb1db.reset();})();ackMsg;"},{"name":"__silent_Branch_6c477affd88e47b6baa2bf2189abb1db","applicable":"vaVars.previous_graph_node==\"Does question satisfy dependency?___6011a8913f454c5f8f2eaaa131969d9f\" &amp;&amp; (function execute() {\n    return vaVars.currentIsDependencySatisfied;\n})()\n","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Yes___6c477affd88e47b6baa2bf2189abb1db\";vaInputs.__silent_Branch_6c477affd88e47b6baa2bf2189abb1db=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Yes___6c477affd88e47b6baa2bf2189abb1db\";var ackMsg=null;ackMsg=null;(function() {vaInputs.show_text_input_question.reset();})();ackMsg;"},{"name":"__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00","applicable":"vaVars.previous_graph_node==\"Does question satisfy dependency?___6011a8913f454c5f8f2eaaa131969d9f\" &amp;&amp; (function execute() {\n    return !vaVars.currentIsDependencySatisfied;\n})()\n","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"No___eb38e61a1c7a44318b35a9fe1b99da00\";vaInputs.__silent_Branch_eb38e61a1c7a44318b35a9fe1b99da00=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"No___eb38e61a1c7a44318b35a9fe1b99da00\";var ackMsg=null;ackMsg=null;vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();(function() {vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();})();ackMsg;"},{"name":"__silent_ScriptOutputPrompt_3d281abf4c1445e88f6c4e9f4355b5aa","applicable":"vaVars.previous_graph_node==\"Confirmation?___753d10c4610243a7afb9e2d6497440d0\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Summary___3d281abf4c1445e88f6c4e9f4355b5aa\";vaInputs.__silent_ScriptOutputPrompt_3d281abf4c1445e88f6c4e9f4355b5aa=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Summary___3d281abf4c1445e88f6c4e9f4355b5aa\";var ackMsg=null;ackMsg=(function execute() {\n   return (function execute() {\n      var questions = JSON.parse(vaVars.surveyQuestions);\n      var answers = JSON.parse(vaVars.surveyAnswers);\n      var questionAnswerPairs = [];\n\n      questions.forEach(function(q) {\n            var question = q.display.toString();\n            var answer = answers[q.metric];\n            var questionAnswer = answer.displayValue != null ? answer.displayValue :\n            answer.value != null ? answer.value : '';\n            var questionType = q.type + '';\n            \n            if(questionType == 'checkbox' || questionType == 'boolean'){\n                  if (questionAnswer == \"1\") {\n                        questionAnswer = \"Yes\";\n                  } else if (questionAnswer == \"0\") {\n                        questionAnswer = \"No\"\n                  }\n            }\n            if(answer){questionAnswerPairs.push({\"fieldLabel\": question, \"fieldValue\": questionAnswer});}         \n      });\n      \n      var card_data = JSON.stringify({\n            \"title\":gs.getMessageLang(\"Response Summary\", vaContext.getRequesterLang()),\n            \"fields\":questionAnswerPairs,\n      });\n\n      return vaSystem.renderCard(\"PreChat\", card_data);\n})();\n})();(function() {vaInputs.verify_response.reset();})();ackMsg;"},{"name":"verify_response","applicable":"vaVars.previous_graph_node==\"Summary___3d281abf4c1445e88f6c4e9f4355b5aa\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Verify Response___333777c7c58b491ebb10a9a22cc88b67\";vaVars.surveyVerificationMsg","input_prompt_format_type":"text","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Verify Response___333777c7c58b491ebb10a9a22cc88b67\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Decision_67f6b5c25c0349fca01f762818747a3f.reset();})();(function() {vaInputs.__silent_Branch_deafcd47cf254d2d974bca8d99a6e274.reset();})();(function() {vaInputs.__silent_Branch_e6dea0290dd9404db627f40ec07c016e.reset();})();ackMsg;"},{"name":"__silent_OutputPrompt_83e6c0162f974497bf0c38ba331ca93c","applicable":"vaVars.previous_graph_node==\"Submit survey answers___a0c96f7fc6b04b77bef514dcbee7a8db\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"End note___83e6c0162f974497bf0c38ba331ca93c\";vaInputs.__silent_OutputPrompt_83e6c0162f974497bf0c38ba331ca93c=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"End note___83e6c0162f974497bf0c38ba331ca93c\";var ackMsg=null;ackMsg=(function execute() {return vaVars.endNote;})();(function() {vaInputs.__silent_TerminateGoal_ef9ce937b7b8414f94c69aa4d7332c0d.reset();})();ackMsg;","acknowledge_msg_mask_type":"NONE"},{"name":"show_image_scale_question","applicable":"vaVars.previous_graph_node==\"Show text input question___b8ab4786574d415fa82e8f192b1ef80c\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show image scale question___46cc86904c21428ebb8d811a82f28566\";var vaRuntimeUtil = new global.VaTopicRuntimeUtil();var funcObj = {\"customApplies\": function() {return (function() {return (function execute() {\n    if (vaVars.currentQuestionType === 'imagescale') {\n        vaInputs.show_image_scale_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_16fb1f224b724fb996c94eefab3d9c06 &gt; 0;}};(function execute() {var promptMsg=null;if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {promptMsg = (function execute() {\n    return vaVars.currentQuestionDisplay;\n})()\n;}else {vaInputs.show_image_scale_question=\"\";}return promptMsg;})();","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show image scale question___46cc86904c21428ebb8d811a82f28566\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'imagescale') {\n        vaInputs.show_image_scale_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n;if(applies){ackMsg=(function execute() {var vaRuntimeUtil=new global.VaTopicRuntimeUtil();var funcObj={\"customApplies\": function() {return (function() {return (function execute() {\n    if (vaVars.currentQuestionType === 'imagescale') {\n        vaInputs.show_image_scale_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_16fb1f224b724fb996c94eefab3d9c06 &gt; 0;}};var acknowledgeMsg=gs.getMessageLang(\"No data found\", vaContext.getRequesterLang());if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {acknowledgeMsg=(function execute() {return null;})();}return acknowledgeMsg;})();(function() {vaInputs.show_choice_question.reset();})();}else{(function() {vaInputs.show_choice_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"__silent_Decision_67f6b5c25c0349fca01f762818747a3f","applicable":"vaVars.previous_graph_node==\"Verify Response___333777c7c58b491ebb10a9a22cc88b67\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Summary Correct?___67f6b5c25c0349fca01f762818747a3f\";vaInputs.__silent_Decision_67f6b5c25c0349fca01f762818747a3f=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Summary Correct?___67f6b5c25c0349fca01f762818747a3f\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_deafcd47cf254d2d974bca8d99a6e274.reset();})();(function() {vaInputs.__silent_Branch_e6dea0290dd9404db627f40ec07c016e.reset();})();ackMsg;"},{"name":"__silent_TerminateGoal_ef9ce937b7b8414f94c69aa4d7332c0d","applicable":"vaVars.previous_graph_node==\"End note___83e6c0162f974497bf0c38ba331ca93c\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"End___ef9ce937b7b8414f94c69aa4d7332c0d\";vaInputs.__silent_TerminateGoal_ef9ce937b7b8414f94c69aa4d7332c0d=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"End___ef9ce937b7b8414f94c69aa4d7332c0d\";var ackMsg=null;ackMsg=null;vaVars.__segment_trigger_c4f28e8715ca4d87a6ff3db95cddd198_done=true;(function execute() {var tmp={values:{}};tmp.populated=true;vaVars._reusable_topic_outputs_var=JSON.stringify(tmp);})();ackMsg;"},{"name":"__silent_Branch_e6dea0290dd9404db627f40ec07c016e","applicable":"vaVars.previous_graph_node==\"Summary Correct?___67f6b5c25c0349fca01f762818747a3f\" &amp;&amp; ((vaInputs.verify_response.getValue() == true))","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Yes___e6dea0290dd9404db627f40ec07c016e\";vaInputs.__silent_Branch_e6dea0290dd9404db627f40ec07c016e=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Yes___e6dea0290dd9404db627f40ec07c016e\";var ackMsg=null;ackMsg=null;vaInputs.__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db.reset();(function() {vaInputs.__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db.reset();})();ackMsg;"},{"name":"__silent_Branch_deafcd47cf254d2d974bca8d99a6e274","applicable":"vaVars.previous_graph_node==\"Summary Correct?___67f6b5c25c0349fca01f762818747a3f\" &amp;&amp; ((vaInputs.verify_response.getValue() == false))","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"No___deafcd47cf254d2d974bca8d99a6e274\";vaInputs.__silent_Branch_deafcd47cf254d2d974bca8d99a6e274=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"No___deafcd47cf254d2d974bca8d99a6e274\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_43028a8d0b22477a86cbf77f88f1b527.reset();})();ackMsg;"},{"name":"show_choice_question","applicable":"vaVars.previous_graph_node==\"Show image scale question___46cc86904c21428ebb8d811a82f28566\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show choice question___e3e9cf36ad4443d494e45fc99d2a318d\";var vaRuntimeUtil = new global.VaTopicRuntimeUtil();var funcObj = {\"customApplies\": function() {return (function() {return (function execute() {\n    if (vaVars.choiceTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        vaInputs.show_choice_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    }\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_87bfa0c129514fef88d414679852002f &gt; 0;}};(function execute() {var promptMsg=null;if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {promptMsg = (function execute() {\n    return vaVars.currentQuestionDisplay;\n})()\n;}else {vaInputs.show_choice_question=\"\";}return promptMsg;})();","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show choice question___e3e9cf36ad4443d494e45fc99d2a318d\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.choiceTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        vaInputs.show_choice_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    }\n        return false;\n})()\n;if(applies){ackMsg=(function execute() {var vaRuntimeUtil=new global.VaTopicRuntimeUtil();var funcObj={\"customApplies\": function() {return (function() {return (function execute() {\n    if (vaVars.choiceTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        vaInputs.show_choice_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    }\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_87bfa0c129514fef88d414679852002f &gt; 0;}};var acknowledgeMsg=gs.getMessageLang(\"No data found\", vaContext.getRequesterLang());if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {acknowledgeMsg=(function execute() {return null;})();}return acknowledgeMsg;})();(function() {vaInputs.show_boolean_question.reset();})();}else{(function() {vaInputs.show_boolean_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db","applicable":"(vaVars.previous_graph_node==\"Yes___e6dea0290dd9404db627f40ec07c016e\" || vaVars.previous_graph_node==\"No___2f0ce9bdd0eb41e683658cd0e7434347\")","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Submit survey answers___a0c96f7fc6b04b77bef514dcbee7a8db\";(function execute() {(function execute() {\n    if(vaInputs.savequestionstocontext == 'true'){ \n        vaVars.surveyInstanceId = new sn_assessment_core.AssessmentCreation().createAssessments(vaInputs.surveyid, '', gs.getUserID(), false, '', false, '', vaVars._interaction_record_sysid, false, 'interaction');\n        vaVars.surveyInstanceId = vaVars.surveyInstanceId.substring(0, 32);\n        vaVars.LiveAgent_pre_assessment_instance = vaVars.surveyInstanceId;\n        vaVars.LiveAgent_pre_chat_survey_name = vaVars.surveyName;\n    } else{ \n        vaVars.surveyInstanceId = new sn_assessment_core.AssessmentCreation().createAssessments(vaInputs.surveyid, '', vaVars._topic_postchat_user_id, false, '', false, '', vaVars._interaction_record_sysid, false, 'interaction');\n        vaVars.surveyInstanceId = vaVars.surveyInstanceId.substring(0, 32);\n        vaVars.LiveAgent_post_assessment_instance = vaVars.surveyInstanceId;\n        vaVars.LiveAgent_post_chat_survey_name = vaVars.surveyName;    \n    }\n\n    var answers = JSON.parse(vaVars.surveyAnswers);\n    var data = {\n        sysparm_instance_id: vaVars.surveyInstanceId,\n        sysparm_action: 'submit'\n    };\n\n    var questionData = new global.TopicPreChatUtil().getQuestionData(vaVars.surveyInstanceId);\n\n    Object.keys(answers).forEach(function(q) {\n        if (answers[q] &amp;&amp; answers[q] &amp;&amp; answers[q].value != null){ \n            if (answers[q]['Qtype'] === 'boolean') {\n                data['ASMTQUESTION:' + questionData[q].instanceID] = (answers[q]['value'] === true) ? '1' : '0';\n            } else if (answers[q]['Qtype'] === 'checkbox') {\n                data['ASMTQUESTION:' + questionData[q].instanceID] = (answers[q]['value'] === true) ? 'true' : '';\n            } else\n                data['ASMTQUESTION:' + questionData[q].instanceID] = answers[q]['value'];\n            if (vaInputs.savequestionstocontext == 'true')\n                saveToContext(questionData[q].name, answers[q], questionData[q].contextVar, questionData[q].type);\n        }\n        \n    });\n    var response = new global.AssessmentSubmitProcessor().processRequest(data);\n})()\n\nfunction saveToContext(name, a, contextVar, type){\n        if(contextVar != \"\") {\n            var contextVarName = contextVar;\n        } else {\n            //remove all special characters and replace spaces with _\n            var questionName = name.toString().replace(/[^a-zA-Z0-9]/g, '_').replace(/_$/,'');     \n            //append survey name to question name\n            var contextVarName = \"liveagent_\" +vaVars.surveyName +\".\"+ questionName;\n        }\n        vaVars[contextVarName] = a.value.toString();\n        //for choice questions, store response and not response index as context var\n        if (type === 'imagescale' || vaVars.choiceTypes.split(',').indexOf(type) &gt; -1) { \n             vaVars[contextVarName] = a.displayValue.toString();    \n        }\n};})();vaInputs.__silent_ScriptedAction_a0c96f7fc6b04b77bef514dcbee7a8db=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Submit survey answers___a0c96f7fc6b04b77bef514dcbee7a8db\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_OutputPrompt_83e6c0162f974497bf0c38ba331ca93c.reset();})();ackMsg;"},{"name":"show_boolean_question","applicable":"vaVars.previous_graph_node==\"Show choice question___e3e9cf36ad4443d494e45fc99d2a318d\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show boolean question___7b1bdf3ceffe4c7db3891ddc58023bb4\";var promptMsg=null;var applies=(function execute() {\n    if ((vaVars.currentQuestionType === 'boolean') || (vaVars.currentQuestionType === 'checkbox')) {\n        vaInputs.show_boolean_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    }\n        return false;\n})();if(applies){}else{vaInputs.show_boolean_question=\"\";}(function execute() {\n    return vaVars.currentQuestionDisplay;\n})()\n;","input_prompt_format_type":"text","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show boolean question___7b1bdf3ceffe4c7db3891ddc58023bb4\";var ackMsg=null;var applies=(function execute() {\n    if ((vaVars.currentQuestionType === 'boolean') || (vaVars.currentQuestionType === 'checkbox')) {\n        vaInputs.show_boolean_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    }\n        return false;\n})();if(applies){ackMsg=null;(function() {vaInputs.show_attachment_question.reset();})();}else{(function() {vaInputs.show_attachment_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"__silent_ScriptedAction_43028a8d0b22477a86cbf77f88f1b527","applicable":"vaVars.previous_graph_node==\"No___deafcd47cf254d2d974bca8d99a6e274\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Reset Question Index___43028a8d0b22477a86cbf77f88f1b527\";(function execute() {(function execute() {\n    vaVars.questionIndex = -1;\n})();})();vaInputs.__silent_ScriptedAction_43028a8d0b22477a86cbf77f88f1b527=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Reset Question Index___43028a8d0b22477a86cbf77f88f1b527\";var ackMsg=null;ackMsg=null;vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();(function() {vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();})();ackMsg;"},{"name":"show_attachment_question","applicable":"vaVars.previous_graph_node==\"Show boolean question___7b1bdf3ceffe4c7db3891ddc58023bb4\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show attachment question___f15a83f70fef43fbbe4ceb4431ab8f80\";var promptMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'attachment') {\n        vaInputs.show_attachment_question.setRequired (vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){}else{vaInputs.show_attachment_question=\"\";}(function execute() {\n    return vaVars.currentQuestionDisplay;\n})()\n;","input_prompt_format_type":"text","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show attachment question___f15a83f70fef43fbbe4ceb4431ab8f80\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'attachment') {\n        vaInputs.show_attachment_question.setRequired (vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){ackMsg=null;(function() {vaInputs.show_date_question.reset();})();}else{(function() {vaInputs.show_date_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"show_date_question","applicable":"vaVars.previous_graph_node==\"Show attachment question___f15a83f70fef43fbbe4ceb4431ab8f80\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show date question___ec913ccf75994dedb7757214dcdf5238\";var promptMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'date') {\n        vaInputs.show_date_question.setRequired (vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){}else{vaInputs.show_date_question=new GlideDateTime('1970-01-01T00:00:00Z');}(function execute() {\n    return vaVars.currentQuestionDisplay;\n})();","input_prompt_format_type":"text","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show date question___ec913ccf75994dedb7757214dcdf5238\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'date') {\n        vaInputs.show_date_question.setRequired (vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){ackMsg=null;(function() {vaInputs.show_datetime_question.reset();})();}else{(function() {vaInputs.show_datetime_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"show_datetime_question","applicable":"vaVars.previous_graph_node==\"Show date question___ec913ccf75994dedb7757214dcdf5238\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show datetime question___721d38e4dd0b49388739184ee551500d\";var promptMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'datetime') {\n        vaInputs.show_datetime_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})();if(applies){}else{vaInputs.show_datetime_question=new GlideDateTime('1970-01-01T00:00:00Z');}(function execute() {\n    return vaVars.currentQuestionDisplay;\n})();","input_prompt_format_type":"text","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show datetime question___721d38e4dd0b49388739184ee551500d\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.currentQuestionType === 'datetime') {\n        vaInputs.show_datetime_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})();if(applies){ackMsg=null;(function() {vaInputs.show_reference_question.reset();})();}else{(function() {vaInputs.show_reference_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"show_reference_question","applicable":"vaVars.previous_graph_node==\"Show datetime question___721d38e4dd0b49388739184ee551500d\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show reference question___3cd6d46bf350443c99ec0cf199c44b21\";var vaRuntimeUtil = new global.VaTopicRuntimeUtil();var funcObj = {\"customApplies\": function() {return (function() {return (function execute() {\n    if ((vaVars.currentQuestionType === 'reference')) {\n        vaInputs.show_reference_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_85acd4f511814be192263f3144b2fa72 &gt; 0;}};(function execute() {var promptMsg=null;if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {promptMsg = (function execute() {\n    return vaVars.currentQuestionDisplay;\n})()\n;}else {vaInputs.show_reference_question=\"\";}return promptMsg;})();","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show reference question___3cd6d46bf350443c99ec0cf199c44b21\";var ackMsg=null;var applies=(function execute() {\n    if ((vaVars.currentQuestionType === 'reference')) {\n        vaInputs.show_reference_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n;if(applies){ackMsg=(function execute() {var vaRuntimeUtil=new global.VaTopicRuntimeUtil();var funcObj={\"customApplies\": function() {return (function() {return (function execute() {\n    if ((vaVars.currentQuestionType === 'reference')) {\n        vaInputs.show_reference_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else\n        return false;\n})()\n})();},\"applies\": function() {return this.customApplies() &amp;&amp; vaVars.optionsCount_85acd4f511814be192263f3144b2fa72 &gt; 0;}};var acknowledgeMsg=gs.getMessageLang(\"No reference found\", vaContext.getRequesterLang());if (vaRuntimeUtil.executeFunction(funcObj, 'applies')) {acknowledgeMsg=(function execute() {return null;})();}return acknowledgeMsg;})();(function() {vaInputs.__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4.reset();})();}else{(function() {vaInputs.__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4.reset();})();ackMsg=null;}ackMsg;"},{"name":"__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4","applicable":"vaVars.previous_graph_node==\"Show reference question___3cd6d46bf350443c99ec0cf199c44b21\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Answer validation___a4c7e98fe1694f83bb2b07ec57141ea4\";(function execute() {(function execute() {\n    vaVars.currentAnswerValidation = true;\n    vaVars.currentAnswerErrorMsg = '';\n\n    if (vaVars.currentQuestionType === 'long' || vaVars.currentQuestionType === 'percentage')\n        validateFieldLimits();\n})();\n\nfunction validateFieldLimits() {\n\tif ((!vaInputs.show_text_input_question.isValueSet() || vaInputs.show_text_input_question.getValue().length == 0)\n\t    &amp;&amp; !vaInputs.show_text_input_question.isRequired())\n\t\treturn;\n\tvar max = vaVars.currentQuestionMax;\n\tvar min = vaVars.currentQuestionMin;\n\t\t\n\tvar value = vaInputs.show_text_input_question.getValue();\n\tvar newvalue = Number(value);\n\tif (isNaN(newvalue)) {vaVars.currentAnswerValidation = false;vaVars.currentAnswerErrorMsg = gs.getMessageLang('The input value is not a valid number. Please try again', vaContext.getRequesterLang());\n\t} else if (newvalue &gt; max || newvalue &lt; min) {vaVars.currentAnswerValidation = false;vaVars.currentAnswerErrorMsg = gs.getMessageLang('The input value is outside the valid range. Please try again', vaContext.getRequesterLang());\n\t}\n};})();vaInputs.__silent_ScriptedAction_a4c7e98fe1694f83bb2b07ec57141ea4=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Answer validation___a4c7e98fe1694f83bb2b07ec57141ea4\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb.reset();})();(function() {vaInputs.__silent_Decision_e5ad34e6099945d7849c834eef1bd479.reset();})();(function() {vaInputs.__silent_Branch_5cab11de08604629a23a24f9bb6dc003.reset();})();ackMsg;"},{"name":"__silent_Decision_e5ad34e6099945d7849c834eef1bd479","applicable":"vaVars.previous_graph_node==\"Answer validation___a4c7e98fe1694f83bb2b07ec57141ea4\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Check range___e5ad34e6099945d7849c834eef1bd479\";vaInputs.__silent_Decision_e5ad34e6099945d7849c834eef1bd479=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Check range___e5ad34e6099945d7849c834eef1bd479\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb.reset();})();(function() {vaInputs.__silent_Branch_5cab11de08604629a23a24f9bb6dc003.reset();})();ackMsg;"},{"name":"__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb","applicable":"vaVars.previous_graph_node==\"Check range___e5ad34e6099945d7849c834eef1bd479\" &amp;&amp; (function execute() {\n    return vaVars.currentAnswerValidation;\n})()","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"In range___bdd204f9d5de4502a1bdcefb402294eb\";vaInputs.__silent_Branch_bdd204f9d5de4502a1bdcefb402294eb=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"In range___bdd204f9d5de4502a1bdcefb402294eb\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_ScriptedAction_a8d89721cb3e4a4db791922ecc6162a5.reset();})();ackMsg;"},{"name":"__silent_Branch_5cab11de08604629a23a24f9bb6dc003","applicable":"vaVars.previous_graph_node==\"Check range___e5ad34e6099945d7849c834eef1bd479\" &amp;&amp; (function execute() {\n    return !vaVars.currentAnswerValidation;\n})()","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Out of range___5cab11de08604629a23a24f9bb6dc003\";vaInputs.__silent_Branch_5cab11de08604629a23a24f9bb6dc003=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Out of range___5cab11de08604629a23a24f9bb6dc003\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_OutputPrompt_2caec646461549eb9f074d49dd8da84a.reset();})();ackMsg;"},{"name":"__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86","applicable":"(vaVars.previous_graph_node==\"Set answers___a8d89721cb3e4a4db791922ecc6162a5\" || vaVars.previous_graph_node==\"No___eb38e61a1c7a44318b35a9fe1b99da00\" || vaVars.previous_graph_node==\"Introduction___f6f516977b564f16b892a5fc51a780aa\" || vaVars.previous_graph_node==\"Reset Question Index___43028a8d0b22477a86cbf77f88f1b527\")","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Set next question___1dd720d7fda945c1bb7cd0b26f6b9c86\";(function execute() {(function execute() {\n    vaVars.questionIndex++;\n    if (!(vaVars.questionCount &amp;&amp; vaVars.questionIndex &lt; vaVars.questionCount))\n        return;\n\n    var i = vaVars.questionIndex;\n    var questions = JSON.parse(vaVars.surveyQuestions);\n\n    // Set question type &amp; display value\n    vaVars.currentQuestionId = questions[i].sys_id;\n    vaVars.currentQuestionType = questions[i].type;\n    vaVars.currentQuestionMetric = questions[i].metric;\n    vaVars.currentQuestionDisplay = questions[i].display;\n    vaVars.currentQuestionMax = questions[i].max;\n    vaVars.currentQuestionMin = questions[i].min;\n    vaVars.currentQuestionMandatory = questions[i].mandatory;\n    vaVars.currentQuestionFieldValidator = questions[i].field_validation;\n    vaVars.currentQuestionReferenceTable = questions[i].reference_table;\n    vaVars.currentQuestionReferenceCondition = questions[i].condition;\n\n    // Load choices if relevant\n    if (questions[i].type === 'imagescale' || vaVars.choiceTypes.split(',').indexOf(questions[i].type) &gt; -1) {\n        questions[i].choices = getChoices(questions[i]);\n        vaVars.surveyQuestions = JSON.stringify(questions);\n    }\n})();\n\nfunction getChoices(q) {\n    var gr = new GlideRecord('asmt_metric_definition');\n    gr.addQuery('metric', q.metric);\n    gr.orderBy('order');\n    gr.query();\n\n    var choices = [];\n    while (gr.next()) {\n        choices.push({\n            sys_id: gr.getUniqueValue(),\n            display: vaSystem.getTranslation(gr, 'display', vaContext.getRequesterLang(),gr.display),\n            value: gr.getValue('value'),\n            selected: gr.getDisplayValue('selected_image'),\n            unselected: gr.getDisplayValue('unselected_image')\n        });\n    }\n    return choices;\n};})();vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Set next question___1dd720d7fda945c1bb7cd0b26f6b9c86\";var ackMsg=null;ackMsg=null;(function() {vaInputs.__silent_Decision_7ea23b4b7ed64e938ade9211dc995758.reset();})();(function() {vaInputs.__silent_Branch_dbfea879b6534ead8a8760734f7d15fe.reset();})();(function() {vaInputs.__silent_Branch_d247234716fa4d32a88aa182297546ea.reset();})();ackMsg;"},{"name":"show_text_input_question","applicable":"(vaVars.previous_graph_node==\"Yes___6c477affd88e47b6baa2bf2189abb1db\" || vaVars.previous_graph_node==\"Validation failed___2caec646461549eb9f074d49dd8da84a\")","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Show text input question___b8ab4786574d415fa82e8f192b1ef80c\";var promptMsg=null;var applies=(function execute() {\n    if (vaVars.textTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        vaInputs.show_text_input_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){}else{vaInputs.show_text_input_question=\"\";}(function execute() {\n    if (vaVars.currentQuestionType === 'long')\n        return gs.getMessageLang('{0} (Range: {1} - {2})', vaContext.getRequesterLang(), [vaVars.currentQuestionDisplay, vaVars.currentQuestionMin, vaVars.currentQuestionMax]);\n    else if (vaVars.currentQuestionType === 'percentage')\n        return gs.getMessageLang('{0} (Range: {1} - {2} %)', vaContext.getRequesterLang(), [vaVars.currentQuestionDisplay,vaVars.currentQuestionMin, vaVars.currentQuestionMax]);\n    else\n        return vaVars.currentQuestionDisplay;\n})();","input_prompt_format_type":"Custom","input_prompt_validaton_script":"function validate(value) {\n    // for \"skip\" which has input value as empty, long or percentage type, general string type with no validator defined\n    if ((gs.nil(value) &amp;&amp; vaVars.currentQuestionMandatory === 'false') || vaVars.currentQuestionType === 'long' || vaVars.currentQuestionType === 'percentage' || gs.nil(vaVars.currentQuestionFieldValidator))\n        return {\n            valid: true,\n        }; \n\n    // for string type with validator defined, and question is not skipped\n    var validatorGr = new GlideRecord(\"sys_cs_field_script_validator\");\n    if (!validatorGr.isValid())\n\t    return {\n           valid: false,\n           error: gs.getMessageLang(\"validator table does not exist\", vaContext.getRequesterLang())\n        };\n\n    if (validatorGr.get(vaVars.currentQuestionFieldValidator)) {\n        var scriptBuild = \"(\" + validatorGr.validator + \")('\"+ value + \"');\";\n        var isValidAnswer = eval(scriptBuild);\n        return {\n            valid: isValidAnswer,\n            error: isValidAnswer ? undefined : validatorGr.error_message + ''\n        };\n    } else {\n        return {\n            valid: false,\n            error: gs.getMessageLang(\"validator record does not exist\", vaContext.getRequesterLang())\n        };\n    }\n}","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":true,"acknowledge_msg":"vaVars.previous_graph_node=\"Show text input question___b8ab4786574d415fa82e8f192b1ef80c\";var ackMsg=null;var applies=(function execute() {\n    if (vaVars.textTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        vaInputs.show_text_input_question.setRequired(vaVars.currentQuestionMandatory);\n        return true;\n    } else \n        return false;\n})();if(applies){ackMsg=null;(function() {vaInputs.show_image_scale_question.reset();})();}else{(function() {vaInputs.show_image_scale_question.reset();})();ackMsg=null;}ackMsg;"},{"name":"__silent_ScriptedAction_a8d89721cb3e4a4db791922ecc6162a5","applicable":"vaVars.previous_graph_node==\"In range___bdd204f9d5de4502a1bdcefb402294eb\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Set answers___a8d89721cb3e4a4db791922ecc6162a5\";(function execute() {(function execute() {\n    var answers = JSON.parse(vaVars.surveyAnswers);\n    answers[vaVars.currentQuestionId] = getInput();\n    vaVars.surveyAnswers = JSON.stringify(answers);\n})();\n\nfunction getInput() {\n    var values = {'value': null, 'Qtype': vaVars.currentQuestionType, 'displayValue':null};\n    if (vaVars.choiceTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        values.value = getValueIfSet(vaInputs.show_choice_question);\n        values.displayValue = getDisplayValueIfSet(vaInputs.show_choice_question,values.value);\n    }\n\n    if (vaVars.textTypes.split(',').indexOf(vaVars.currentQuestionType) &gt; -1) {\n        values.value = getValueIfSet(vaInputs.show_text_input_question);\n        values.displayValue = getDisplayValueIfSet(vaInputs.show_text_input_question,values.value);\n    }\n\n    switch (vaVars.currentQuestionType) {\n        case 'imagescale':\n            values.value = getValueIfSet(vaInputs.show_image_scale_question);\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_image_scale_question,values.value);\n            var questions = JSON.parse(vaVars.surveyQuestions);\n            //stores correct displayValue, vaInputs returns display+value\n            if(vaInputs.show_image_scale_question &amp;&amp; vaInputs.show_image_scale_question != null){\n                questions[vaVars.questionIndex].choices.forEach(function(c){\n                    if(c.value === values.value)\n                        values.displayValue = c.display;\n                });\n            }\n            break;\n        case 'boolean':\n            values.value = getValueIfSet(vaInputs.show_boolean_question);\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_boolean_question,values.value);\n            break;\n        case 'checkbox':\n            values.value= getValueIfSet(vaInputs.show_boolean_question);\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_boolean_question,values.value);\n            break;\n        case 'attachment':\n            values.value = getValueIfSet(vaInputs.show_attachment_question);\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_attachment_question,values.value);\n            break;\n        case 'date':\n            const date = getValueIfSet(vaInputs.show_date_question);\n            values.value = (date != null) ? date.toString() : null;\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_date_question,values.value);\n            break;\n        case 'datetime':\n            const dateTime = getValueIfSet(vaInputs.show_datetime_question);\n            values.value = (dateTime != null) ? dateTime.toString() : null;\n            vaInputs.show_datetime_question.setTimeZone(vaContext.getDeviceTimeZone());\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_datetime_question,values.value);\n            break;\n        case 'reference':\n            values.value = getValueIfSet(vaInputs.show_reference_question);\n            values.displayValue = getDisplayValueIfSet(vaInputs.show_reference_question,values.value);\n    }\n    return values;\n}\n\nfunction getValueIfSet(field){\n    return field &amp;&amp; field.isValueSet() ? field.getValue() : null;\n}\n\nfunction getDisplayValueIfSet(field, val){\n    if (!field || field == null)\n       return val;\n    var dv = field.getDisplayValue();\n     return dv &amp;&amp; dv.length &gt; 0  ? dv : val;\n};})();vaInputs.__silent_ScriptedAction_a8d89721cb3e4a4db791922ecc6162a5=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Set answers___a8d89721cb3e4a4db791922ecc6162a5\";var ackMsg=null;ackMsg=null;vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();(function() {vaInputs.__silent_ScriptedAction_1dd720d7fda945c1bb7cd0b26f6b9c86.reset();})();ackMsg;"},{"name":"__silent_OutputPrompt_2caec646461549eb9f074d49dd8da84a","applicable":"vaVars.previous_graph_node==\"Out of range___5cab11de08604629a23a24f9bb6dc003\"","direction":"Input","required":true,"prompt_msg":"vaVars.previous_graph_node=\"Validation failed___2caec646461549eb9f074d49dd8da84a\";vaInputs.__silent_OutputPrompt_2caec646461549eb9f074d49dd8da84a=true;null;","confirm_msg_on_default_value":{"msg":"","val_for_confirm":true},"nlu_text_input":false,"nlu_confirmation_prompt":false,"acknowledge_msg":"vaVars.previous_graph_node=\"Validation failed___2caec646461549eb9f074d49dd8da84a\";var ackMsg=null;ackMsg=(function execute() {\n    return vaVars.currentAnswerErrorMsg;\n})();vaInputs.show_text_input_question.reset();(function() {vaInputs.show_text_input_question.reset();})();ackMsg;","acknowledge_msg_mask_type":"NONE"}],"variables_update":[]}],"roles":[],"active":true,"published":true,"library":true,"expose_on_palette":false,"palette_label":"Survey Poc","flexible_conversation_switching":true,"design_categories":[],"nlu_provider":"","nlu_model":"","nlu_intent":"","topic_type":"TOPIC_BLOCK","channels":[],"triggerable_by_notification":false,"secure_custom_input_control":false,"score":0.0,"visible":false,"discoverable":false,"sys_scope":"eb7c99fb87924110b09f206f8bbb3523","sys_domain":"global","title":"Survey Poc","nlu_intent_label":"","nlu_model_label":""}</definition>
        <design_category/>
        <discoverable>false</discoverable>
        <expose_on_palette>false</expose_on_palette>
        <fields/>
        <flexible_conversation_switching>true</flexible_conversation_switching>
        <is_system_topic>false</is_system_topic>
        <key_phrases/>
        <last_published_on>2022-08-23 18:54:55</last_published_on>
        <library>true</library>
        <library_usage>{"type":"Library","input-parameters":[{"name":"surveyid","label":"surveyId","default-value":"\"\"","required":true,"metadata":{"type":"String","list":false,"items":[],"use_items":false},"id":"8cbaa293aa77475993c23001d26aa339","type":"String","hint":""},{"name":"confirmationneeded","label":"confirmationNeeded","default-value":"\"false\"","required":true,"metadata":{"type":"String","list":false,"items":[],"use_items":false},"id":"6ba88e09886d4c6eae94fea77067db5e","type":"String","hint":""},{"name":"savequestionstocontext","label":"saveQuestionsToContext","default-value":"\"false\"","required":true,"metadata":{"type":"String","list":false,"items":[],"use_items":false},"id":"42894b70841b4879a54cdfba0fd4ab96","type":"String","hint":""}],"return-values-mapping":[]}</library_usage>
        <metaphone/>
        <name>Survey Poc</name>
        <nlu_intent/>
        <nlu_intent_label/>
        <nlu_model/>
        <nlu_model_label/>
        <nlu_provider/>
        <palette_label>Survey Poc</palette_label>
        <published>true</published>
        <roles/>
        <secure_custom_input_control>false</secure_custom_input_control>
        <sys_class_name>sys_cs_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-08-23 18:54:55</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>a9cbc9f887a591102840eb173cbb35f2</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Survey Poc</sys_name>
        <sys_package display_value="Innovate" source="x_777497_innovate">eb7c99fb87924110b09f206f8bbb3523</sys_package>
        <sys_policy/>
        <sys_scope display_value="Innovate">eb7c99fb87924110b09f206f8bbb3523</sys_scope>
        <sys_update_name>sys_cs_topic_a9cbc9f887a591102840eb173cbb35f2</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-08-23 18:54:55</sys_updated_on>
        <title>Survey Poc</title>
        <triggerable_by_notification>false</triggerable_by_notification>
        <type>TOPIC_BLOCK</type>
        <vendor display_value="ServiceNow">c2f0b8f187033200246ddd4c97cb0bb9</vendor>
        <visible>false</visible>
    </sys_cs_topic>
    <sys_variable_value action="delete_multiple" query="document_key=a9cbc9f887a591102840eb173cbb35f2"/>
</record_update>
